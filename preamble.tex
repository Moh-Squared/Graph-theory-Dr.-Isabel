% =============================================================
% PREAMBLE.TEX - VISUAL STYLE MATCHED TO REAL ANALYSIS
% =============================================================

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{lmodern} 

% --- Page Layout ---
\usepackage[a4paper, margin=2.5cm, headheight=15pt]{geometry}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{needspace}

% --- Math & Symbols ---
\usepackage{amsmath, amssymb, amsthm, amsfonts}
\usepackage{mathtools}
\usepackage{stmaryrd} 

% --- Graphics & Colors ---
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{tikz} 
\usetikzlibrary{positioning, arrows.meta, shapes, calc}

% --- Color Definitions (Exact Match) ---
\definecolor{aucred}{RGB}{140, 0, 50}   
\definecolor{aucteal}{RGB}{0, 96, 96}   
\definecolor{aucblue}{RGB}{0, 0, 60}    

% --- Hyperlinks ---
\usepackage[colorlinks=true, linkcolor=aucblue, urlcolor=aucblue, citecolor=aucblue]{hyperref}

% --- CUSTOM HEADER STYLING ---
\usepackage{titlesec}

% 1. Section Numbering: "1." instead of "1.1"
\renewcommand{\thesection}{\arabic{section}}

% 2. Chapter Heading Style (Double Rules, Small Caps)
\titleformat{\chapter}[display]
  {\normalfont\centering\color{aucblue}}
  {\titlerule[2.5pt]\vspace{2pt}\titlerule[1pt] \vspace{1ex} \huge\scshape\chaptertitlename\ \thechapter}
  {1ex}
  {\titlerule[1pt]\vspace{2pt}\titlerule[2.5pt] \vspace{4ex} \Huge\scshape}
  []

% 3. Section Heading Style (Centered, Large, Small Caps)
\titleformat{\section}
  {\normalfont\Large\scshape\centering\color{aucblue}} 
  {\thesection.} 
  {0.7em} 
  {}

% --- UNIFIED COUNTER SYSTEM ---
% A single counter 'seq' for EVERYTHING (Recall, Defs, Theorems)
\newcounter{seq}[chapter]
\renewcommand{\theseq}{\thechapter.\arabic{seq}}

% --- Custom Command for Text Topics (Recall, Visualisation, etc.) ---
\newcommand{\topic}[1]{%
    \par\vspace{0.5cm}\noindent%
    \refstepcounter{seq}%
    {\large \underline{\textbf{\theseq~#1}}}%
    \par\vspace{0.2cm}%
}

% --- BOX ENVIRONMENTS (FIXED VISUALS) ---
\usepackage[most]{tcolorbox}

% Global Box Style: Full Header, Thin Border, Rounded
\tcbset{
    auccommon/.style={
        enhanced jigsaw,
        fonttitle=\bfseries,
        coltitle=white,
        boxrule=1pt,        % Thin border (Matches screenshot)
        arc=2mm,              % Rounded corners
        left=2mm, right=2mm, top=2mm, bottom=2mm, % Inner padding
        toptitle=0.5mm, bottomtitle=0.5mm, % Header padding
        oversize=0pt,         % Prevents box from spilling into margins
    }
}

% 1. Definition Box (Red Header, Light Red Body)
\newtcolorbox{definition}[1][]{%
    auccommon,
    breakable,
    lines before break=5,
    colback=aucred!5!white, 
    colframe=aucred, 
    colbacktitle=aucred,
    title=Definition~\refstepcounter{seq}\theseq~#1
}

% 2. Theorem Box (Teal Header, Light Teal Body)
\newtcolorbox{theorem}[1][]{%
    auccommon,
    breakable,
    lines before break=5,
    colback=aucteal!5!white, 
    colframe=aucteal, 
    colbacktitle=aucteal,
    title=Theorem~\refstepcounter{seq}\theseq~#1
}

% 3. Lemma Box (Teal Header)
\newtcolorbox{lemma}[1][]{%
    auccommon,
    breakable,
    lines before break=5,
    colback=aucteal!5!white, 
    colframe=aucteal, 
    colbacktitle=aucteal,
    title=Lemma~\refstepcounter{seq}\theseq~#1
}

% 4. Corollary Box (Teal Header)
\newtcolorbox{corollary}[1][]{%
    auccommon,
    breakable,
    lines before break=5,
    colback=aucteal!5!white, 
    colframe=aucteal, 
    colbacktitle=aucteal,
    title=Corollary~\refstepcounter{seq}\theseq~#1
}

% 5. Example Environment (Text Only, Blue Label)
\newenvironment{example}[1][]{%
    \par\vspace{0.5cm}\noindent
    \refstepcounter{seq}%
    \textbf{\color{aucblue}Example \theseq.} \textit{#1} \par
}{\par\vspace{0.5cm}}

% 6. Remark Environment (Text Only, Blue Label)
\newenvironment{remark}[1][]{%
    \par\vspace{0.5cm}\noindent
    \refstepcounter{seq}%
    \textbf{\color{aucblue}Remark \theseq.} \textit{#1} \par
}{\par\vspace{0.5cm}}

% Proof Environment
\let\oldproof\proof
\let\endoldproof\endproof
\renewenvironment{proof}{\oldproof}{\endoldproof}

% --- Graph Macros ---
\newcommand{\V}[1]{V(#1)}
\newcommand{\E}[1]{E(#1)}
\newcommand{\degv}[1]{\text{deg}(#1)}
\newcommand{\deltaG}{\delta(G)}
\newcommand{\DeltaG}{\Delta(G)}